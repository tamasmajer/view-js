let e="undefined"!=typeof window?window:void 0,ie=({window:i=e??globalThis,t:a="View",value:l="value",o:z=10}={})=>{function A(e,t){return t?ae(((e,t)=>{let r=h(e)===y?e:[e],n=$(()=>b(r.map(e=>e?._state?.val??(e?.i!==g?e.val:e)))),o,a;return()=>o===n.val?a:(o=n.val)&&(a=t())})(e,t)):(h(e)===d?ae:T)(e)}let u=i.document,G=i===e?i.fetch.bind(i):i.fetch,f=Object,h=e=>f.getPrototypeOf(e??0),s,w,o,v,J={isConnected:1},n=1e3,t,M={},c=h(J),d=h(h),g,y=h([]),p=h(""),{stringify:b,parse:_}=JSON,N=e=>"a"<=e[0]&&e[0]<="z",R=(e,t,r,n)=>(e??(setTimeout(r,n),new Set)).add(t),U=(e,t,r)=>{var n=o;o=t;try{return e(r)}finally{o=n}},m=e=>e.filter(e=>e.l?.isConnected),Z=e=>t=R(t,e,()=>{for(var e of t)e.u=m(e.u),e.h=m(e.h);t=g},n),S={get val(){return o?.v?.add(this),this.rawVal},get oldVal(){return o?.v?.add(this),this.i},set val(e){o?.g?.add(this),e!==this.rawVal&&(this.rawVal=e,this.u.length+this.h.length?(w?.add(this),s=R(s,this,K)):this.i=e)},get[l](){return this.val},set[l](e){this.val=e}},T=e=>({__proto__:S,rawVal:e,i:e,u:[],h:[]}),x=(e,r)=>new Proxy(e,{get:(e,t)=>r(t),apply:(e,t,r)=>e(...r)}),C=r=>x(function(e){return 0===arguments.length?r.val:r.val=e},e=>{if("_state"===e)return r;var t=r.val;if(t?.nodeType||t?.content){e=E(e,t.content??t);if(e)return(e.content?L:F)(e)}return g}),P=(e,t)=>{var r,n,o,a={v:new Set,g:new Set},i={f:e},l=v;v=[];let u=U(e,a,t);h(u)===y?(r=u.map(e=>e?.nodeType?e:new Text(!1===e?"":e??"")),u=j(),e.p&&":"===u.tagName&&(u.p=!0,u._=t.parentNode??null),V(u,...r)):u=u?.nodeType?u:new Text(!1===u?"":u??"");for(n of a.v)a.g.has(n)||(Z(n),n.u.push(i));for(o of v)o.l=u;return v=l,i.l=u},$=(e,t=T(),r)=>{var n,o={v:new Set,g:new Set},a={f:e,s:t};a.l=r??v?.push(a)??J,t.val=U(e,o,t.rawVal);for(n of o.v)o.g.has(n)||(Z(n),n.h.push(a));return t},V=(e,...t)=>{t=t.flat(1/0);var r=e._;if(!r&&1===t.length&&null===t[0]?._)return t[0]._=e,V(t[0],[...t[0].children]);var n=r?e._:e;t=r?[...t,e]:t,r&&n.replaceChildren();for(let e of t){var o=h(e),o=o===S?P(()=>e.val):o===d?P(e):e;o!=g&&n.append(o)}return e},B=(l,e)=>{for(let[a,i]of f.entries(e)){let t=e=>e?f.getOwnPropertyDescriptor(e,a)??t(h(e)):g,e=l.tagName+","+a,r=M[e]??=t(h(l))?.set??0,n=a.startsWith("on")?(e,t)=>{var r=a.slice(2);l.removeEventListener(r,t),l.addEventListener(r,e)}:r?r.bind(l):l.setAttribute.bind(l,a),o=h(i);a.startsWith("on")||o===d&&(i=$(i),o=S),o===S?P(()=>(n(i.val,i.i),l)):n(i)}},H=e=>e.remove(),I=(e,t)=>e.replaceWith(t),K=()=>{let e=0,t=[...s].filter(e=>e.rawVal!==e.i);do{w=new Set;for(var r of new Set(t.flatMap(e=>e.h=m(e.h))))$(r.f,r.s,r.l),r.l=g}while(++e<100&&(t=[...w]).length);var n,o,a,i,l=[...s].filter(e=>e.rawVal!==e.i);s=g;for(n of new Set(l.flatMap(e=>e.u=m(e.u))))o=n.l,a=P(n.f,n.l),a?a!==o&&I(o,a):H(o),n.l=g;for(i of l)i.i=i.rawVal},Q=e=>((e,t,...r)=>{1===r.length&&h(r[0])===y&&(r=r[0]);let[{is:n,...o},...a]=h(r[0])===c?r:[{},...r],i=e?.nodeType?e:e?u.createElementNS(e,t,{is:n}):u.createElement(t,{is:n});return B(i,o),V(i,a)}).bind(g,g,e),E=(e,t=u)=>""===e||t.matches?.(`[${a}="${e}"]`)?t:(t.content??t).querySelector(`[${a}="${e}"]`),X=(e,t=u)=>{for(var r of t.querySelectorAll("template")){if(r.getAttribute(a)===e)return r;r=E(e,r.content??r);if(r)return r}},L=t=>x((...e)=>re(t,e),e=>e===l?t:(e=E(e,t.content??t))?(e.content?L:F)(e):g),O=e=>h(e[0])===c?e:[{},...e],j=()=>u.createElement(":"),Y=(...e)=>V(j(),...e),ee=(e,...t)=>{e.replaceChildren(),V(e,...t)},te=e=>{e.querySelectorAll?.(`[${a}]`).forEach(e=>e.removeAttribute(a)),e.hasAttribute?.(a)&&e.removeAttribute(a)},re=(e,t)=>{var r=e.content,n=r?1===r?.children?.length?r.children[0].cloneNode(1):Y(...r.cloneNode(1).children):e.isConnected?e:e.cloneNode(1),[r,...t]=O(t),o={};if(!t.length)for(var[a,i]of f.entries(r))N(a)?o[a]=i:(a=E(a,n))&&D(a,i);return D(n,[o,...t]),n!==e&&te(n),n},D=(e,t)=>{h(t)!==y&&(t=[t]);var r=h(t[0])===c&&t.shift();return 1===t.length&&t[0]?._state&&(t[0]=t[0]._state),1===t.length&&h(t[0])===d&&(t[0].p=!0,t[0]=P(t[0],j())),r&&B(e,r),t.length&&ee(e,t),e},r=new WeakMap,ne=(e,t="")=>{return r.has(e)||r.set(e,{}),o=e,a=r.get(e),i=t,new Proxy({},{get:(e,r)=>{let n=i+r;if(!a[n]){r=o.getItem(n);let t=T(r?_(r):g);a[n]=t,$(()=>{var e=t.val;e===g||null===e?o.removeItem(n):o.setItem(n,b(e))})}return C(a[n])}});var o,a,i},F=r=>new Proxy((...e)=>e.length?D(r,O(e)):r,{get:(e,t)=>t===l?r:(t=E(t,r.content??r))?F(t):g}),oe=(s,w={})=>(e={})=>{let{method:t,headers:r,body:n,query:o,loading:a,m:i,result:l,path:u,url:f}=e={...w,...e};return f=(f||"")+(u||""),o&&(f+=(f.includes("?")?"&":"?")+new URLSearchParams(o)),t||=void 0!==n?"POST":"GET",r={"Content-Type":"application/json",...r},n=h(n)===c?b(n):n,a?.(f),s(f,{method:t,headers:r,body:n}).then(async e=>e.ok?await e.text().then(e=>{try{e=_(e)}catch{}var t=l?.(e);return t===g?e:t}):i?.({response:e})).catch(e=>i?.({error:e})).finally(()=>a?.())},W=(e,t,n,r={})=>{let{S:o={}}=r,a=T(g),i=oe(e,{}),l=(a._isRemote=!0,a._fetch=e,a._baseConfig=o,e=>{let t=(e=>{console.log("payload",e);let t=h(o)===d?o(e):o,r=(h(t)===p&&(t={url:t}),console.log("base",t),h(n)===p?{url:n}:h(n)===d?n(e):n||{});return console.log("config",r),h(r)===p&&(r={url:r}),{...t,...r,headers:{...t.headers,...r.headers}}})(e);return console.log({T:t}),i({...t,body:null===e||e===g?g:t.body,result:e=>{a.val=e,t.result?.(e)}}),e});return t?$(()=>{t.forEach(e=>e.val),l()}):h(n)===d?$(()=>l()):l(),f.assign(function(e){return arguments.length?l(e):a.val},{_state:a})},ae=t=>{let r=T(g),n=null,o=!0;return $(()=>{let e=t();return clearTimeout(n),o?(o=!1,r.val=(e?.then,e)):n=setTimeout(async()=>{r.val=e?.then?await e:e},z),e}),r},k=(r,n={})=>f.assign(function(...e){var[e,t]=e;return h(e)===y?W(r,e,t,{S:n}):W(r,null,e,{S:n})},{_isFetchConfigurator:!0,_fetch:r,_baseConfig:n}),q=new Proxy(A,{apply:(e,t,n)=>{let[o,a]=n;var r;if(o===i||o?.nodeType)return 0<(r=n.slice(1)).length?(D(o,O(r)),o):F(o);if(o?.getItem&&o?.setItem)return ne(o,a);if(o?.prototype?.parseFromString||o?.parseFromString){if(1===n.length)return(...e)=>q(o,...e);let t=o?.prototype?.parseFromString?new o:o,r=T(g);return $(()=>{var e="function"==typeof a||a?._state?a():a;r.val=e?t.parseFromString(e,"text/html"):g}),(o=>{let a={};return new Proxy(C(o),{get:(e,t)=>{if(a[t])return a[t];let r=T(g);$(()=>{var e=o.val,e=e&&(X(t,e)||E(t,e));r.val=e?.content?L(e):e?F(e):g});var n=x((...e)=>r.val?r.val(...e):g,e=>r.val?.[e]);return a[t]=n},apply:(e,t,r)=>e(...r)})})(r)}return"function"!=typeof o||"fetch"!==o.name&&"bound fetch"!==o.name?o?._isFetchConfigurator?W(o._fetch,null,a,{S:o._baseConfig}):o?._state?._isRemote?W(o._state._fetch,null,a,o):C(e(...n)):1===n.length?k(o,{}):k(o,a)},construct:(e,t)=>ie(...t),get:(e,t)=>{return t===l?(...e)=>C(A(...e)):"A"<=(o=t)[0]&&o[0]<="Z"?(o=t,n=u,((o=X(o,n))?L(o):g)||(n=t,(r=E(n))?f.assign((...e)=>re(r,e),{[l]:r}):g)||("Window"===t?(e,...t)=>q(i,e??{},...t):"Document"===t&&((e,...t)=>q(i.document,e??{},...t)))||"LocalStorage"===t&&q(i.localStorage)||"Fetch"===t&&k(G,{})||("DomParser"===t?(...e)=>q(i.DOMParser,...e):(()=>{throw new Error(`Template or element with ${a}="${t}" not found`)})())):Q(t);var r,n,o}});return addEventListener("storage",e=>{var t=r.get(i.localStorage);t?.[e.key]&&(t[e.key].val=_(e.newValue))}),q};export default ie({t:"View"});